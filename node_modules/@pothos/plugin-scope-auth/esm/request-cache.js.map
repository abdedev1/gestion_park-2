{"version":3,"sources":["../src/request-cache.ts"],"names":["createContextCache","isThenable","PothosValidationError","AuthScopeFailureType","cacheKey","canCache","contextCache","ctx","builder","RequestCache","fromContext","context","clearForContext","delete","getScopes","scopes","options","authScopes","then","resolved","withScopes","cb","resolvedScopes","saveGrantedScopes","path","key","grantCache","has","set","get","forEach","scope","add","Set","testGrantedScopes","prev","grantTypeScopes","type","parent","typeGrants","Map","cache","result","evaluateScopeLoader","name","arg","scopeCache","loader","String","treatErrorsAsUnauthorized","error","kind","AuthScope","parameter","promise","r","catch","evaluateScopeMapWithScopes","$all","$any","$granted","map","info","forAll","scopeNames","Object","keys","problems","failure","AllAuthScopes","AnyAuthScopes","failures","loaderList","scopeName","push","promises","GrantedScope","anyResult","evaluateScopeMap","allResult","resolveAndReturn","loaderName","length","Promise","all","results","hasSuccess","val","defaultStrategy","AuthScopeFunction","mapCache","evaluateTypeScopeFunction","typeCache","constructor","scopeAuthOptions"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}