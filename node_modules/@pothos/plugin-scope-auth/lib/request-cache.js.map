{"version":3,"sources":["../src/request-cache.ts"],"names":["RequestCache","contextCache","createContextCache","ctx","builder","fromContext","context","clearForContext","delete","getScopes","scopes","options","authScopes","isThenable","then","resolved","withScopes","cb","resolvedScopes","saveGrantedScopes","path","key","cacheKey","grantCache","has","set","get","forEach","scope","add","Set","testGrantedScopes","prev","grantTypeScopes","type","parent","typeGrants","Map","cache","result","evaluateScopeLoader","name","arg","scopeCache","loader","PothosValidationError","String","treatErrorsAsUnauthorized","error","kind","AuthScopeFailureType","AuthScope","parameter","promise","r","catch","evaluateScopeMapWithScopes","$all","$any","$granted","map","info","forAll","scopeNames","Object","keys","problems","failure","AllAuthScopes","AnyAuthScopes","failures","loaderList","scopeName","push","promises","GrantedScope","anyResult","evaluateScopeMap","allResult","resolveAndReturn","loaderName","length","Promise","all","results","hasSuccess","val","defaultStrategy","AuthScopeFunction","mapCache","canCache","evaluateTypeScopeFunction","typeCache","constructor","scopeAuthOptions"],"rangeMappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;","mappings":"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"}