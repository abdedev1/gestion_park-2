"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    internalDecodeGlobalID: function() {
        return internalDecodeGlobalID;
    },
    internalEncodeGlobalID: function() {
        return internalEncodeGlobalID;
    }
});
const _core = require("@pothos/core");
const _globalids = require("./global-ids");
function internalEncodeGlobalID(builder, typename, id, ctx) {
    if (builder.options.relayOptions.encodeGlobalID) {
        return builder.options.relayOptions.encodeGlobalID(typename, id, ctx);
    }
    return (0, _globalids.encodeGlobalID)(typename, id);
}
function internalDecodeGlobalID(builder, globalID, ctx, info, parseIdsForTypes) {
    const decoded = builder.options.relayOptions.decodeGlobalID ? builder.options.relayOptions.decodeGlobalID(globalID, ctx) : (0, _globalids.decodeGlobalID)(globalID);
    if (Array.isArray(parseIdsForTypes)) {
        const entry = parseIdsForTypes.find(({ typename })=>typename === decoded.typename);
        if (!entry) {
            throw new _core.PothosValidationError(`ID: ${globalID} is not of type: ${parseIdsForTypes.map(({ typename })=>typename).join(', ')}`);
        }
        if (entry.parseId) {
            return {
                ...decoded,
                id: entry.parseId(decoded.id, ctx)
            };
        }
        return decoded;
    }
    if (parseIdsForTypes) {
        var _info_schema_getType_extensions, _info_schema_getType;
        const parseID = (_info_schema_getType = info.schema.getType(decoded.typename)) === null || _info_schema_getType === void 0 ? void 0 : (_info_schema_getType_extensions = _info_schema_getType.extensions) === null || _info_schema_getType_extensions === void 0 ? void 0 : _info_schema_getType_extensions.pothosParseGlobalID;
        if (parseID) {
            return {
                ...decoded,
                id: parseID(decoded.id, ctx)
            };
        }
    }
    return decoded;
}

//# sourceMappingURL=internal.js.map